---
import MainLayout from "../layouts/MainLayout.astro";
import ProductCard from "../components/ProductCard.astro";
import products from "../data/products.json";

const pageTitle = `FLOOR BOSS ng - All Products`;
const pageDescription = `Explore our complete collection of flooring solutions.`;
const pageCanonicalURL = Astro.url.origin + Astro.url.pathname;
---

<MainLayout
  title={pageTitle}
  description={pageDescription}
  canonicalURL={pageCanonicalURL}
>
  <div class="container mx-auto px-4 md:px-6 py-10 md:py-16">
    <section class="relative overflow-hidden rounded-3xl bg-[#f6f2ea] border border-stone-200/60 p-6 md:p-10">
      <div class="pointer-events-none absolute -top-16 -right-20 h-56 w-56 rounded-full bg-gradient-to-br from-amber-200/70 via-orange-200/40 to-transparent blur-3xl"></div>
      <div class="pointer-events-none absolute -bottom-16 -left-10 h-56 w-56 rounded-full bg-gradient-to-tr from-emerald-200/60 via-lime-200/40 to-transparent blur-3xl"></div>
      <div class="grid md:grid-cols-[1.2fr_0.8fr] gap-6 items-center">
        <div>
          <p class="text-xs uppercase tracking-[0.35em] text-stone-500">
            Full Catalog
          </p>
          <h1 class="text-4xl sm:text-5xl md:text-6xl font-black text-stone-900 leading-tight mt-2">
            All Products
          </h1>
          <p class="mt-4 text-base sm:text-lg text-stone-600 max-w-xl">
            Browse our complete selection of SPC, vinyl, and flooring
            accessories ready for Abuja delivery.
          </p>
        </div>
        <div class="rounded-2xl border border-stone-200 bg-white/80 p-6 shadow-sm">
          <p class="text-xs uppercase tracking-[0.3em] text-stone-500">
            Bulk Orders
          </p>
          <p class="text-lg font-semibold text-stone-900 mt-2">
            Contractor & office pricing
          </p>
          <p class="text-sm text-stone-600 mt-2">
            Dedicated quotes with material planning support.
          </p>
        </div>
      </div>
    </section>

    <section class="py-10">
      <div class="grid md:grid-cols-3 gap-4 mb-8">
        <div class="md:col-span-2 rounded-2xl border border-stone-200 bg-white p-4 shadow-sm">
          <label for="search-input" class="text-xs uppercase tracking-[0.3em] text-stone-500">
            Search
          </label>
          <div class="relative mt-3">
            <input
              type="search"
              id="search-input"
              placeholder="Search products..."
              class="w-full pl-11 pr-4 py-3 border border-stone-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-stone-500"
            />
            <svg
              class="absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-stone-400"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              aria-hidden="true"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
          </div>
        </div>
        <div class="rounded-2xl border border-stone-200 bg-white p-4 shadow-sm">
          <label for="sort-select" class="text-xs uppercase tracking-[0.3em] text-stone-500">
            Sort
          </label>
          <div class="relative mt-3">
            <select
              id="sort-select"
              class="w-full appearance-none bg-white border border-stone-200 rounded-xl py-3 px-4 pr-10 focus:outline-none focus:ring-2 focus:ring-stone-500"
            >
              <option value="default">Sort by</option>
              <option value="price-asc">Price: Low to High</option>
              <option value="price-desc">Price: High to Low</option>
            </select>
            <svg
              class="absolute right-4 top-1/2 -translate-y-1/2 h-5 w-5 text-stone-400"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              aria-hidden="true"
            >
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
        </div>
      </div>
      <div
        id="product-grid"
        class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8"
      >
        {
          products.map((product) => (
            <a
              href={`/${product.id}`}
              class="font-bold text-stone-700 hover:text-stone-900 uppercase product-card"
              data-name={product.name.toLowerCase()}
              data-price={product.price}
            >
              <ProductCard
                id={product.id}
                name={product.name}
                price={product.price}
                image={product.image}
                description={product.description}
              />
            </a>
          ))
        }
      </div>
    </section>
  </div>
</MainLayout>

<script>
  const searchInput = document.getElementById('search-input');
  const sortSelect = document.getElementById('sort-select');
  const productGrid = document.getElementById('product-grid');
  const productCards = Array.from(productGrid.querySelectorAll('.product-card'));

  function filterAndSortProducts() {
    const searchTerm = searchInput.value.toLowerCase();
    const sortValue = sortSelect.value;

    let filtered = productCards.filter(card => {
      return card.dataset.name.includes(searchTerm);
    });

    if (sortValue === 'price-asc') {
      filtered.sort((a, b) => parseFloat(a.dataset.price) - parseFloat(b.dataset.price));
    } else if (sortValue === 'price-desc') {
      filtered.sort((a, b) => parseFloat(b.dataset.price) - parseFloat(a.dataset.price));
    }

    productGrid.innerHTML = '';
    filtered.forEach(card => {
      productGrid.appendChild(card);
    });
  }

  searchInput.addEventListener('input', filterAndSortProducts);
  sortSelect.addEventListener('change', filterAndSortProducts);
</script>
